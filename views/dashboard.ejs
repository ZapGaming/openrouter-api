<!DOCTYPE html>
<html>
<head>
    <title>Zandymon World</title>
    <style>
        body { background: #11111b; color: #cdd6f4; font-family: 'Segoe UI', sans-serif; text-align: center; margin: 0; }
        .nav { background: #181825; padding: 15px; border-bottom: 2px solid #fab387; display: flex; justify-content: space-around; }
        .boss-area { background: linear-gradient(to bottom, #1e1e2e, #11111b); padding: 40px; border: 2px solid #f38ba8; margin: 20px; border-radius: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; padding: 40px; }
        .card { background: #313244; padding: 20px; border-radius: 15px; border: 1px solid #585b70; position: relative; }
        .emoji { font-size: 3rem; display: block; margin-bottom: 10px; }
        .hp-bar { background: #45475a; height: 10px; border-radius: 5px; margin: 10px 0; overflow: hidden; }
        .hp-fill { background: #a6e3a1; height: 100%; transition: width 0.3s; }
        button { background: #fab387; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <div class="nav">
        <span>üí∞ Essence: <%= user.essence %></span>
        <span>üèÜ Rank: <%= user.rank.toUpperCase() %></span>
    </div>

    <div class="boss-area">
        <h2>üëæ <%= boss.name %></h2>
        <div class="hp-bar" style="width: 60%; margin: auto;"><div class="hp-fill" style="width: <%= (boss.hp / boss.maxHp) * 100 %>%"></div></div>
        <p><%= boss.hp %> / <%= boss.maxHp %> HP</p>
    </div>

    <div class="grid">
        <% user.monsters.forEach(m => { %>
            <div class="card">
                <span class="emoji"><%= m.emoji || 'üåÄ' %></span>
                <h3><%= m.name %></h3>
                <p><b>Element:</b> <%= m.element %></p>
                <p>‚öîÔ∏è ATK: <%= m.atk %> | ‚ù§Ô∏è HP: <%= m.hp %></p>
                <button onclick="attackBoss('<%= m._id %>')">‚öîÔ∏è ATTACK BOSS</button>
            </div>
        <% }) %>
    </div>

    <script>
        async function attackBoss(mId) {
            const res = await fetch('/attack-boss', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ token: "<%= token %>", monsterId: mId })
            });
            const data = await res.json();
            if(data.success) location.reload();
        }
    </script>
</body>
</html>
